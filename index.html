<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Happy Valentineâ€™s Day ðŸ’–</title>

    <style>
      :root {
        --bg1: #070914;
        --bg2: #141a3a;

        --pink1: #ff4fa0;
        --pink2: #ff80ab;
        --pink3: #ffc1e3;

        --red1: #e31717;
        --red2: #ff5b5b;

        /* PINK (Flower) */
        --p1: #ec407a;
        --p2: #ff80ab;
        --p3: #ffc1e3;

        /* RED (Flower) */
        --rd1: #b80f0f;
        --rd2: #e31717;
        --rd3: #ff5b5b;

        /* greens */
        --stem: #163316;
        --leaf: #2f7a2f;
        --leaf2: #3f943f;
      }

      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }

      body {
        margin: 0;
        overflow: hidden;
        font-family:
          system-ui,
          -apple-system,
          Segoe UI,
          Roboto,
          Arial,
          sans-serif;
        background:
          radial-gradient(
            900px 600px at 70% 25%,
            rgba(255, 80, 150, 0.12) 0%,
            transparent 55%
          ),
          radial-gradient(
            1100px 800px at 20% 75%,
            rgba(60, 170, 255, 0.1) 0%,
            transparent 55%
          ),
          linear-gradient(160deg, var(--bg1), var(--bg2));
        cursor: pointer;
        color: white;
        -webkit-tap-highlight-color: transparent;
        user-select: none;
      }

      /* ===== PAGE WRAP ===== */
      .page {
        position: fixed;
        inset: 0;
        opacity: 0;
        pointer-events: none;
        transition: opacity 520ms ease;
      }
      .page.active {
        opacity: 1;
        pointer-events: auto;
      }

      /* ===== SMOOTH FADE LAYER (transition overlay) ===== */
      .fade-layer {
        position: fixed;
        inset: 0;
        background:
          radial-gradient(
            900px 600px at 70% 25%,
            rgba(255, 80, 150, 0.12) 0%,
            transparent 55%
          ),
          radial-gradient(
            1100px 800px at 20% 75%,
            rgba(60, 170, 255, 0.1) 0%,
            transparent 55%
          ),
          linear-gradient(160deg, var(--bg1), var(--bg2));
        opacity: 0;
        pointer-events: none;
        transition: opacity 520ms ease;
        z-index: 9999;
      }
      .fade-layer.show {
        opacity: 1;
      }

      /* =========================
         INDEX (Intro) STYLES
      ========================== */

      .sceneIntro {
        position: relative;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1;
        padding: 20px;
      }

      .petalsIntro {
        position: absolute;
        inset: 0;
        overflow: hidden;
        pointer-events: none;
        z-index: 0;
      }

      .petalIntro {
        position: absolute;
        top: -12vh;
        width: var(--ps);
        height: calc(var(--ps) * 0.75);
        border-radius: 999px;
        background: linear-gradient(180deg, var(--petalA), var(--petalB));
        opacity: 0.8;
        animation:
          fallIntro var(--dur) linear infinite,
          driftIntro var(--dur2) ease-in-out infinite;
        animation-delay: var(--delay);
      }

      @keyframes fallIntro {
        to {
          transform: translateY(120vh);
        }
      }
      @keyframes driftIntro {
        0%,
        100% {
          margin-left: 0;
        }
        50% {
          margin-left: var(--dx);
        }
      }

      .card {
        position: relative;
        z-index: 5;
        width: min(900px, 92vw);
        padding: clamp(20px, 4vw, 50px);
        border-radius: 28px;
        background: rgba(20, 20, 45, 0.85);
        border: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.55);
        text-align: center;
        cursor: pointer;
      }

      .heroTitle {
        margin: 0 0 20px;
        font-weight: 900;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        line-height: 1.05;

        font-size: clamp(38px, 5.5vw, 72px);

        white-space: normal;
        word-break: keep-all;
        overflow-wrap: normal;
        text-align: center;

        background: linear-gradient(90deg, #ff5b5b, #ff4fa0, #ffc1e3, #e31717);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;

        text-shadow:
          0 0 6px rgba(255, 80, 150, 0.4),
          0 0 14px rgba(255, 20, 90, 0.2);

        animation: floatTitle 4.5s ease-in-out infinite alternate;
      }

      @keyframes floatTitle {
        from {
          transform: translateY(0);
        }
        to {
          transform: translateY(-8px);
        }
      }

      .sub {
        font-size: clamp(14px, 2vw, 18px);
        opacity: 0.9;
      }

      .pill {
        margin-top: 18px;
        display: inline-block;
        padding: 10px 16px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid rgba(255, 255, 255, 0.1);
        font-size: 13px;
      }

      @media (max-width: 520px) {
        .heroTitle {
          white-space: normal;
          font-size: clamp(44px, 10vw, 65px);
        }
      }

      /* =========================
         FLOWER (Bouquet) STYLES
      ========================== */

      .bokeh {
        position: fixed;
        inset: -10%;
        pointer-events: none;
        background:
          radial-gradient(
            240px 240px at 12% 28%,
            rgba(255, 120, 180, 0.1),
            transparent 62%
          ),
          radial-gradient(
            260px 260px at 82% 34%,
            rgba(120, 210, 255, 0.1),
            transparent 64%
          ),
          radial-gradient(
            220px 220px at 62% 82%,
            rgba(255, 200, 120, 0.06),
            transparent 64%
          ),
          radial-gradient(
            300px 300px at 30% 78%,
            rgba(120, 255, 190, 0.06),
            transparent 64%
          );
        filter: blur(2px);
        animation: floatBG 18s ease-in-out infinite alternate;
        opacity: 0.9;
        z-index: 0;
      }
      @keyframes floatBG {
        from {
          transform: translate3d(-12px, 10px, 0) scale(1);
        }
        to {
          transform: translate3d(14px, -12px, 0) scale(1.03);
        }
      }

      .sceneFlower {
        position: relative;
        width: 100vw;
        height: 100vh;
        display: grid;
        place-items: center;
        isolation: isolate;
        z-index: 1;
      }

      .ground {
        position: absolute;
        bottom: clamp(22px, 5vh, 60px);
        width: min(620px, 86vw);
        height: 56px;
        background: radial-gradient(
          closest-side,
          rgba(0, 0, 0, 0.45),
          transparent 70%
        );
        filter: blur(1px);
        opacity: 0.55;
      }

      .hint {
        position: absolute;
        top: 14px;
        left: 50%;
        transform: translateX(-50%);
        color: rgba(255, 255, 255, 0.9);
        font-size: 13px;
        letter-spacing: 0.2px;
        padding: 8px 12px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(6px);
        cursor: pointer;
        text-align: center;
        max-width: 92vw;
      }
      .hint b {
        font-weight: 700;
      }

      /* Falling petals (pink/red mixed) */
      .petalRain {
        position: absolute;
        inset: 0;
        overflow: hidden;
        pointer-events: none;
      }
      .petal {
        position: absolute;
        top: -10vh;
        width: var(--ps);
        height: calc(var(--ps) * 0.7);
        border-radius: 999px;
        background: linear-gradient(180deg, var(--petalA), var(--petalB));
        opacity: 0.7;
        transform: translateY(-5vh);
        animation:
          fall var(--dur) linear infinite,
          drift var(--dur2) ease-in-out infinite,
          spin var(--dur3) ease-in-out infinite;
        animation-delay: var(--delay);
      }
      @keyframes fall {
        to {
          transform: translateY(110vh);
        }
      }
      @keyframes drift {
        0%,
        100% {
          margin-left: 0;
        }
        50% {
          margin-left: var(--dx);
        }
      }
      @keyframes spin {
        0%,
        100% {
          rotate: -18deg;
        }
        50% {
          rotate: 22deg;
        }
      }

      .bouquet {
        position: relative;
        width: min(92vmin, 780px);
        height: min(92vmin, 780px);
        display: grid;
        place-items: center;
        transform: translateY(clamp(6px, 1.2vh, 18px));
        cursor: pointer;
      }

      .roseUnit {
        position: absolute;
        left: 50%;
        top: 50%;
        width: clamp(92px, 18vmin, 150px);
        aspect-ratio: 1/1.5;
        transform: translate(-50%, -50%) translate(var(--x), var(--y))
          scale(var(--s)) rotate(var(--tilt));
        transform-origin: 50% 86%;
        will-change: transform;
        animation: sway 10s ease-in-out infinite alternate;
        animation-delay: var(--sd);
        z-index: var(--z);
        pointer-events: none;
      }
      @keyframes sway {
        from {
          transform: translate(-50%, -50%) translate(var(--x), var(--y))
            scale(var(--s)) rotate(calc(var(--tilt) - 1deg));
        }
        to {
          transform: translate(-50%, -50%) translate(var(--x), var(--y))
            scale(var(--s)) rotate(calc(var(--tilt) + 1deg));
        }
      }

      /* ===== PRO LAYERING FIX ===== */
      .roseWrap {
        position: relative;
        width: 100%;
        height: 100%;
      }
      .roseStemLayer,
      .roseHeadLayer {
        position: absolute;
        inset: 0;
      }
      .roseStemLayer {
        z-index: 0;
      }
      .roseHeadLayer {
        z-index: 2;
      }

      /* Bloom */
      .stemGrow {
        transform-origin: 50% 100%;
        transform: scaleY(0.12);
        opacity: 0;
        animation: stemGrow 3.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        animation-delay: calc(var(--bloomDelay) + 0.05s);
      }
      @keyframes stemGrow {
        0% {
          transform: scaleY(0.12);
          opacity: 0;
        }
        60% {
          transform: scaleY(1.02);
          opacity: 1;
        }
        100% {
          transform: scaleY(1);
          opacity: 1;
        }
      }

      .leafGrow {
        transform-origin: 50% 50%;
        transform: scale(0.14);
        opacity: 0;
        animation: leafPop 2.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        animation-delay: calc(var(--bloomDelay) + 1.15s);
      }
      @keyframes leafPop {
        0% {
          transform: scale(0.14);
          opacity: 0;
        }
        65% {
          transform: scale(1.06);
          opacity: 1;
        }
        100% {
          transform: scale(1);
        }
      }

      .head {
        transform-origin: 50% 60%;
        transform: scale(0.1);
        opacity: 0;
        animation: headIn 5.2s cubic-bezier(0.12, 1, 0.22, 1) forwards;
        animation-delay: calc(var(--bloomDelay) + 0.65s);
      }
      @keyframes headIn {
        0% {
          opacity: 0;
          transform: scale(0.1);
        }
        55% {
          opacity: 1;
          transform: scale(1.06);
        }
        100% {
          opacity: 1;
          transform: scale(1);
        }
      }

      .innerOpen {
        transform-origin: 50% 55%;
        transform: scale(0.72);
        opacity: 0;
        animation: innerOpen 4.4s cubic-bezier(0.12, 1, 0.22, 1) forwards;
        animation-delay: calc(var(--bloomDelay) + 1.45s);
      }
      @keyframes innerOpen {
        0% {
          opacity: 0;
          transform: scale(0.72);
        }
        60% {
          opacity: 1;
          transform: scale(1.02);
        }
        100% {
          opacity: 1;
          transform: scale(1);
        }
      }

      .breath {
        transform-origin: 50% 60%;
        animation: breathe 10.5s ease-in-out infinite;
        animation-delay: calc(var(--bloomDelay) + 6.2s);
      }
      @keyframes breathe {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.03);
        }
      }

      /* ===== TOP 6 RED roses (soft V curve) ===== */
      .red1 {
        --x: calc(-28vmin);
        --y: calc(-30vmin);
        --s: 0.95;
        --tilt: -10deg;
        --sd: -0.2s;
        --bloomDelay: 0s;
        --z: 4;
      }
      .red2 {
        --x: calc(-18vmin);
        --y: calc(-34vmin);
        --s: 0.98;
        --tilt: 6deg;
        --sd: -0.25s;
        --bloomDelay: 0.2s;
        --z: 5;
      }
      .red3 {
        --x: calc(-6vmin);
        --y: calc(-37vmin);
        --s: 1.02;
        --tilt: -4deg;
        --sd: -0.2s;
        --bloomDelay: 0.4s;
        --z: 6;
      }
      .red4 {
        --x: calc(6vmin);
        --y: calc(-37vmin);
        --s: 1.02;
        --tilt: 4deg;
        --sd: -0.2s;
        --bloomDelay: 0.6s;
        --z: 6;
      }
      .red5 {
        --x: calc(18vmin);
        --y: calc(-34vmin);
        --s: 0.98;
        --tilt: -6deg;
        --sd: -0.25s;
        --bloomDelay: 0.8s;
        --z: 5;
      }
      .red6 {
        --x: calc(28vmin);
        --y: calc(-30vmin);
        --s: 0.95;
        --tilt: 10deg;
        --sd: -0.2s;
        --bloomDelay: 1s;
        --z: 4;
      }

      /* ===== 7 PINK roses (soft V bottom) ===== */
      .r1 {
        --x: calc(-24vmin);
        --y: calc(-15vmin);
        --s: 0.95;
        --tilt: -10deg;
        --sd: -0.2s;
        --bloomDelay: 1.2s;
        --z: 6;
      }
      .r2 {
        --x: calc(-10vmin);
        --y: calc(-18vmin);
        --s: 1.05;
        --tilt: 7deg;
        --sd: -0.3s;
        --bloomDelay: 1.6s;
        --z: 12;
      }
      .r3 {
        --x: calc(10vmin);
        --y: calc(-18vmin);
        --s: 1.05;
        --tilt: -7deg;
        --sd: -0.2s;
        --bloomDelay: 2s;
        --z: 11;
      }
      .r4 {
        --x: calc(-30vmin);
        --y: calc(-2vmin);
        --s: 0.9;
        --tilt: 12deg;
        --sd: -0.2s;
        --bloomDelay: 2.4s;
        --z: 10;
      }
      .r5 {
        --x: calc(30vmin);
        --y: calc(-2vmin);
        --s: 0.9;
        --tilt: -12deg;
        --sd: -0.2s;
        --bloomDelay: 2.8s;
        --z: 8;
      }
      .r6 {
        --x: calc(0vmin);
        --y: calc(5vmin);
        --s: 1.15;
        --tilt: 0deg;
        --sd: -0.35s;
        --bloomDelay: 3.2s;
        --z: 14;
      }
      .r7 {
        --x: calc(0vmin);
        --y: calc(20vmin);
        --s: 1.2;
        --tilt: 0deg;
        --sd: -0.35s;
        --bloomDelay: 3.6s;
        --z: 15;
      }

      .caption {
        position: absolute;
        bottom: 10px;
        width: 100%;
        text-align: center;
        color: rgba(255, 255, 255, 0.86);
        font-size: 14px;
        letter-spacing: 0.3px;
        opacity: 0.9;
        pointer-events: none;
        padding: 0 12px;
      }
      .caption span {
        opacity: 0.7;
      }

      @media (max-width: 420px) {
        .hint {
          font-size: 12px;
          padding: 7px 10px;
        }
        .caption {
          font-size: 12px;
        }
      }

      @media (prefers-reduced-motion: reduce) {
        * {
          animation: none !important;
        }
        .petalRain {
          display: none;
        }
        .stemGrow,
        .leafGrow,
        .head,
        .innerOpen {
          opacity: 1 !important;
          transform: none !important;
        }
      }
    </style>
  </head>

  <body>
    <div class="fade-layer" id="fadeLayer"></div>

    <!-- MUSIC (NO UI, LOOP FOREVER) -->
    <audio
      id="bgMusic"
      src="./Taylor Swift - Lover.mp3"
      preload="auto"
      loop
      playsinline
    ></audio>

    <!-- =======================
         PAGE 1: INTRO
    ======================== -->
    <section class="page active" id="pageIntro" aria-label="Intro">
      <div class="sceneIntro">
        <div class="petalsIntro" id="petalsIntro"></div>

        <div class="card" id="openBouquet">
          <h1 class="heroTitle" id="heroTitle"></h1>

          <p class="sub">A little surprise is waiting for you ðŸ’—</p>

          <div class="pill">Tap / Click anywhere to open the bouquet</div>
        </div>
      </div>
    </section>

    <!-- =======================
         PAGE 2: FLOWER
    ======================== -->
    <section class="page" id="pageFlower" aria-label="Bouquet">
      <div class="bokeh"></div>

      <div class="sceneFlower">
        <div class="ground"></div>
        <div class="petalRain" id="petalRain" aria-hidden="true"></div>

        <div
          class="hint"
          id="replayBtn"
          role="button"
          tabindex="0"
          aria-label="Replay bloom animation"
        >
          Tap the bouquet to <b>replay bloom</b> âœ¨ðŸ«¶
        </div>

        <div
          class="bouquet"
          id="bouquet"
          aria-label="Bouquet of 13 blooming roses (6 red + 7 pink)"
        >
          <!-- 6 RED -->
          <div class="roseUnit red1" data-color="red"></div>
          <div class="roseUnit red2" data-color="red"></div>
          <div class="roseUnit red3" data-color="red"></div>
          <div class="roseUnit red4" data-color="red"></div>
          <div class="roseUnit red5" data-color="red"></div>
          <div class="roseUnit red6" data-color="red"></div>

          <!-- 7 PINK -->
          <div class="roseUnit r1" data-color="pink"></div>
          <div class="roseUnit r2" data-color="pink"></div>
          <div class="roseUnit r3" data-color="pink"></div>
          <div class="roseUnit r4" data-color="pink"></div>
          <div class="roseUnit r5" data-color="pink"></div>
          <div class="roseUnit r6" data-color="pink"></div>
          <div class="roseUnit r7" data-color="pink"></div>
        </div>

        <div class="caption">
          Happy Valentine's Day
          <span>â€¢ Katrina Selomin â€¢ February 14, 2026</span>
        </div>
      </div>

      <!-- STEM+LEAVES template (shared by both colors) -->
      <template id="roseStem">
        <svg
          viewBox="0 0 220 330"
          xmlns="http://www.w3.org/2000/svg"
          aria-hidden="true"
        >
          <g class="stemGrow">
            <path
              d="M112 312 C110 270, 114 235, 114 200 C114 160, 116 132, 114 110"
              fill="none"
              stroke="var(--stem)"
              stroke-width="12"
              stroke-linecap="round"
            />
          </g>
          <g class="leafGrow">
            <path
              d="M95 206 C70 196, 44 176, 46 150 C75 150, 98 165, 110 188 C116 200, 110 212, 95 206Z"
              fill="var(--leaf2)"
            />
            <path
              d="M136 225 C162 232, 186 252, 179 277 C148 281, 125 266, 113 245 C106 232, 116 221, 136 225Z"
              fill="var(--leaf)"
            />
          </g>
        </svg>
      </template>

      <!-- PINK HEAD template -->
      <template id="headPink">
        <svg
          viewBox="0 0 220 330"
          xmlns="http://www.w3.org/2000/svg"
          aria-hidden="true"
        >
          <g class="head">
            <g class="breath">
              <path
                d="M110 22 C86 22, 66 34, 54 52 C42 70, 40 92, 50 112 C62 136, 84 154, 110 156
                   C136 154, 158 136, 170 112 C180 92, 178 70, 166 52 C154 34, 134 22, 110 22Z"
                fill="var(--p2)"
              />
              <path
                d="M54 82 C56 58, 76 42, 98 40 C86 56, 84 76, 88 98 C72 98, 62 92, 54 82Z"
                fill="var(--p3)"
              />
              <path
                d="M166 82 C164 58, 144 42, 122 40 C134 56, 136 76, 132 98 C148 98, 158 92, 166 82Z"
                fill="var(--p3)"
              />
              <path
                d="M62 118 C82 150, 104 158, 110 158 C116 158, 138 150, 158 118
                   C142 126, 128 130, 110 130 C92 130, 78 126, 62 118Z"
                fill="var(--p3)"
              />
              <path
                d="M110 44 C92 44, 78 54, 72 70 C66 86, 70 102, 82 114 C92 124, 100 128, 110 128
                   C120 128, 128 124, 138 114 C150 102, 154 86, 148 70 C142 54, 128 44, 110 44Z"
                fill="var(--p1)"
              />

              <g class="innerOpen">
                <path
                  d="M110 56 C96 56, 86 64, 84 76 C82 90, 90 102, 102 106 C106 108, 114 108, 118 106
                     C130 102, 138 90, 136 76 C134 64, 124 56, 110 56Z"
                  fill="var(--p3)"
                />
                <path
                  d="M103 74 C106 64, 118 62, 126 70 C134 78, 128 94, 114 98 C102 94, 98 84, 103 74Z"
                  fill="var(--p2)"
                />
                <path
                  d="M92 78 C96 66, 114 60, 128 70"
                  fill="none"
                  stroke="rgba(0,0,0,.18)"
                  stroke-width="4"
                  stroke-linecap="round"
                />
                <path
                  d="M98 100 C112 108, 132 96, 128 82"
                  fill="none"
                  stroke="rgba(0,0,0,.18)"
                  stroke-width="4"
                  stroke-linecap="round"
                />
              </g>
            </g>
          </g>
        </svg>
      </template>

      <!-- RED HEAD template -->
      <template id="headRed">
        <svg
          viewBox="0 0 220 330"
          xmlns="http://www.w3.org/2000/svg"
          aria-hidden="true"
        >
          <g class="head">
            <g class="breath">
              <path
                d="M110 22 C86 22, 66 34, 54 52 C42 70, 40 92, 50 112 C62 136, 84 154, 110 156
                   C136 154, 158 136, 170 112 C180 92, 178 70, 166 52 C154 34, 134 22, 110 22Z"
                fill="var(--rd2)"
              />
              <path
                d="M54 82 C56 58, 76 42, 98 40 C86 56, 84 76, 88 98 C72 98, 62 92, 54 82Z"
                fill="var(--rd3)"
              />
              <path
                d="M166 82 C164 58, 144 42, 122 40 C134 56, 136 76, 132 98 C148 98, 158 92, 166 82Z"
                fill="var(--rd3)"
              />
              <path
                d="M62 118 C82 150, 104 158, 110 158 C116 158, 138 150, 158 118
                   C142 126, 128 130, 110 130 C92 130, 78 126, 62 118Z"
                fill="var(--rd3)"
              />
              <path
                d="M110 44 C92 44, 78 54, 72 70 C66 86, 70 102, 82 114 C92 124, 100 128, 110 128
                   C120 128, 128 124, 138 114 C150 102, 154 86, 148 70 C142 54, 128 44, 110 44Z"
                fill="var(--rd1)"
              />

              <g class="innerOpen">
                <path
                  d="M110 56 C96 56, 86 64, 84 76 C82 90, 90 102, 102 106 C106 108, 114 108, 118 106
                     C130 102, 138 90, 136 76 C134 64, 124 56, 110 56Z"
                  fill="var(--rd3)"
                />
                <path
                  d="M103 74 C106 64, 118 62, 126 70 C134 78, 128 94, 114 98 C102 94, 98 84, 103 74Z"
                  fill="var(--rd2)"
                />
                <path
                  d="M92 78 C96 66, 114 60, 128 70"
                  fill="none"
                  stroke="rgba(0,0,0,.18)"
                  stroke-width="4"
                  stroke-linecap="round"
                />
                <path
                  d="M98 100 C112 108, 132 96, 128 82"
                  fill="none"
                  stroke="rgba(0,0,0,.18)"
                  stroke-width="4"
                  stroke-linecap="round"
                />
              </g>
            </g>
          </g>
        </svg>
      </template>
    </section>

    <script>
      /* =========================
         INTRO TITLE (same logic)
      ========================== */
      const heroTitle = document.getElementById("heroTitle");

      function buildTitle() {
        heroTitle.innerHTML = "";
        const isMobile = window.matchMedia("(max-width:520px)").matches;

        if (isMobile) {
          heroTitle.innerHTML = `
      HAPPY<br>
      VALENTINE'S<br>
      DAY
    `;
        } else {
          heroTitle.innerHTML = "HAPPY VALENTINE'S DAY KATWINA";
        }
      }
      buildTitle();
      window.addEventListener("resize", buildTitle);

      /* =========================
         INTRO PETALS
      ========================== */
      const petalsIntro = document.getElementById("petalsIntro");
      function makeIntroPetals() {
        petalsIntro.innerHTML = "";
        for (let i = 0; i < 20; i++) {
          const p = document.createElement("div");
          p.className = "petalIntro";
          p.style.setProperty("--ps", 10 + Math.random() * 15 + "px");
          p.style.left = Math.random() * 100 + "%";
          p.style.setProperty("--dur", 10 + Math.random() * 10 + "s");
          p.style.setProperty("--dur2", 3 + Math.random() * 4 + "s");
          p.style.setProperty("--delay", -Math.random() * 10 + "s");
          p.style.setProperty("--dx", Math.random() * 40 - 20 + "px");

          const isRed = Math.random() < 0.4;
          p.style.setProperty(
            "--petalA",
            isRed ? "rgba(255,90,90,.9)" : "rgba(255,170,210,.9)",
          );
          p.style.setProperty(
            "--petalB",
            isRed ? "rgba(210,20,20,.9)" : "rgba(236,64,122,.9)",
          );

          petalsIntro.appendChild(p);
        }
      }
      makeIntroPetals();

      /* =========================
         MUSIC (NO OFF OPTION)
      ========================== */
      const bgMusic = document.getElementById("bgMusic");

      function startMusic() {
        if (!bgMusic) return;

        // choose where to start (in seconds)
        const START_AT = 42; // <-- change this (e.g. 10 = 00:10, 75 = 01:15)

        // only do the skip the first time we start music
        const firstStart = bgMusic.paused && bgMusic.currentTime === 0;

        bgMusic.volume = 1;
        bgMusic.loop = false; // IMPORTANT: we handle looping ourselves

        // If user wants a skip at the start:
        if (firstStart) {
          // Some browsers need metadata loaded before setting currentTime
          if (bgMusic.readyState >= 1) {
            bgMusic.currentTime = START_AT;
          } else {
            bgMusic.addEventListener(
              "loadedmetadata",
              () => {
                bgMusic.currentTime = START_AT;
              },
              { once: true },
            );
          }
        }

        const p = bgMusic.play();
        if (p && typeof p.catch === "function") p.catch(() => {});
      }

      // When the song ends, go back to the very beginning (0:00) and play again
      bgMusic.addEventListener("ended", () => {
        bgMusic.currentTime = 0;
        const p = bgMusic.play();
        if (p && typeof p.catch === "function") p.catch(() => {});
      });

      /* =========================
         PAGE SWITCH (NO NAVIGATION)
      ========================== */
      const fadeLayer = document.getElementById("fadeLayer");
      const pageIntro = document.getElementById("pageIntro");
      const pageFlower = document.getElementById("pageFlower");
      const openBouquet = document.getElementById("openBouquet");

      function showFlowerSmooth() {
        // Start music on user gesture, then it loops forever on this page
        startMusic();

        fadeLayer.classList.add("show");

        setTimeout(() => {
          pageIntro.classList.remove("active");
          pageFlower.classList.add("active");

          // start / rebuild flower visuals fresh
          injectAll();
          makePetals();

          fadeLayer.classList.remove("show");
        }, 520);
      }

      openBouquet.addEventListener("click", showFlowerSmooth);

      /* =========================
         FLOWER BUILD (same code)
      ========================== */
      const roses = document.querySelectorAll(".roseUnit");
      const stemTpl = document.getElementById("roseStem");
      const headPink = document.getElementById("headPink");
      const headRed = document.getElementById("headRed");

      function buildRose(isRed) {
        const wrap = document.createElement("div");
        wrap.className = "roseWrap";

        const stemLayer = document.createElement("div");
        stemLayer.className = "roseStemLayer";
        stemLayer.appendChild(
          stemTpl.content.firstElementChild.cloneNode(true),
        );

        const headLayer = document.createElement("div");
        headLayer.className = "roseHeadLayer";
        headLayer.appendChild(
          (isRed ? headRed : headPink).content.firstElementChild.cloneNode(
            true,
          ),
        );

        wrap.appendChild(stemLayer);
        wrap.appendChild(headLayer);
        return wrap;
      }

      function injectAll() {
        roses.forEach((r) => {
          r.innerHTML = "";
          const isRed = r.dataset.color === "red";
          r.appendChild(buildRose(isRed));
        });
      }

      // Falling petals (Flower)
      const rain = document.getElementById("petalRain");
      function makePetals() {
        rain.innerHTML = "";
        const isSmall = window.matchMedia("(max-width: 520px)").matches;
        const count = isSmall ? 14 : 22;

        const w = window.innerWidth;
        for (let i = 0; i < count; i++) {
          const p = document.createElement("div");
          p.className = "petal";

          const base = Math.max(10, Math.min(24, w * 0.018));
          const ps = (base + Math.random() * base * 0.7).toFixed(1) + "px";

          p.style.left = (Math.random() * 100).toFixed(2) + "%";
          p.style.setProperty("--ps", ps);
          p.style.setProperty(
            "--dur",
            (10 + Math.random() * 10).toFixed(2) + "s",
          );
          p.style.setProperty(
            "--dur2",
            (3.5 + Math.random() * 4.5).toFixed(2) + "s",
          );
          p.style.setProperty(
            "--dur3",
            (2.8 + Math.random() * 4.0).toFixed(2) + "s",
          );
          p.style.setProperty(
            "--delay",
            (-Math.random() * 12).toFixed(2) + "s",
          );
          p.style.setProperty(
            "--dx",
            (Math.random() * 36 - 18).toFixed(1) + "px",
          );
          p.style.opacity = (0.38 + Math.random() * 0.32).toFixed(2);

          const isRed = Math.random() < 0.35;
          p.style.setProperty(
            "--petalA",
            isRed ? "rgba(255,90,90,.92)" : "rgba(255,170,210,.92)",
          );
          p.style.setProperty(
            "--petalB",
            isRed ? "rgba(210,20,20,.92)" : "rgba(236,64,122,.92)",
          );

          rain.appendChild(p);
        }
      }

      window.addEventListener("resize", () => {
        if (pageFlower.classList.contains("active")) makePetals();
      });

      /* =========================
         FLOWER REPLAY (same logic)
      ========================== */
      const bouquet = document.getElementById("bouquet");
      const replayBtn = document.getElementById("replayBtn");

      function replay() {
        injectAll();
        makePetals();
        replayBtn.animate(
          [
            { transform: "translateX(-50%) scale(1)" },
            { transform: "translateX(-50%) scale(1.06)" },
            { transform: "translateX(-50%) scale(1)" },
          ],
          { duration: 420, easing: "ease-out" },
        );
      }

      bouquet.addEventListener("click", replay);
      replayBtn.addEventListener("click", replay);
      replayBtn.addEventListener("keydown", (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          replay();
        }
      });
    </script>
  </body>
</html>
